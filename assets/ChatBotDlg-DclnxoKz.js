import{r as n,S as N,n as e,T as j,a9 as Y,aq as W,ar as be,as as Se,s as ve,u as ke,c as Be,at as k,t as Re,R as _,p as J,B as Q,au as Te,q as Ie,k as E}from"./index-C9Wj4eVr.js";import{A as Qe}from"./AutoSuggestQuestions-C8RK94Wm.js";import"./lib-BL9hWg-q.js";const M=n.forwardRef(({className:a,bsPrefix:t,as:r="div",...o},i)=>(t=N(t,"card-body"),e.jsx(r,{ref:i,className:j(a,t),...o})));M.displayName="CardBody";const Z=n.forwardRef(({className:a,bsPrefix:t,as:r="div",...o},i)=>(t=N(t,"card-footer"),e.jsx(r,{ref:i,className:j(a,t),...o})));Z.displayName="CardFooter";const P=n.createContext(null);P.displayName="CardHeaderContext";const ee=n.forwardRef(({bsPrefix:a,className:t,as:r="div",...o},i)=>{const m=N(a,"card-header"),x=n.useMemo(()=>({cardHeaderBsPrefix:m}),[m]);return e.jsx(P.Provider,{value:x,children:e.jsx(r,{ref:i,...o,className:j(t,m)})})});ee.displayName="CardHeader";const te=n.forwardRef(({bsPrefix:a,className:t,variant:r,as:o="img",...i},m)=>{const x=N(a,"card-img");return e.jsx(o,{ref:m,className:j(r?`${x}-${r}`:x,t),...i})});te.displayName="CardImg";const se=n.forwardRef(({className:a,bsPrefix:t,as:r="div",...o},i)=>(t=N(t,"card-img-overlay"),e.jsx(r,{ref:i,className:j(a,t),...o})));se.displayName="CardImgOverlay";const ne=n.forwardRef(({className:a,bsPrefix:t,as:r="a",...o},i)=>(t=N(t,"card-link"),e.jsx(r,{ref:i,className:j(a,t),...o})));ne.displayName="CardLink";const Ee=Y("h6"),ae=n.forwardRef(({className:a,bsPrefix:t,as:r=Ee,...o},i)=>(t=N(t,"card-subtitle"),e.jsx(r,{ref:i,className:j(a,t),...o})));ae.displayName="CardSubtitle";const re=n.forwardRef(({className:a,bsPrefix:t,as:r="p",...o},i)=>(t=N(t,"card-text"),e.jsx(r,{ref:i,className:j(a,t),...o})));re.displayName="CardText";const De=Y("h5"),oe=n.forwardRef(({className:a,bsPrefix:t,as:r=De,...o},i)=>(t=N(t,"card-title"),e.jsx(r,{ref:i,className:j(a,t),...o})));oe.displayName="CardTitle";const ie=n.forwardRef(({bsPrefix:a,className:t,bg:r,text:o,border:i,body:m=!1,children:x,as:w="div",...h},g)=>{const s=N(a,"card");return e.jsx(w,{ref:g,...h,className:j(t,s,r&&`bg-${r}`,o&&`text-${o}`,i&&`border-${i}`),children:m?e.jsx(M,{children:x}):x})});ie.displayName="Card";const D=Object.assign(ie,{Img:te,Title:oe,Subtitle:ae,Body:M,Link:ne,Text:re,Header:ee,Footer:Z,ImgOverlay:se});class X{constructor(t){const{topId:r,id:o,answerTitle:i,answerLink:m}=t;this.chatBotAnswer={topId:r,id:o,answerTitle:i??"",answerLink:m??"",created:t.created,modified:t.modified}}chatBotAnswer}const Me=()=>{const[a,t]=n.useState(null),[r,o]=n.useState(0),i=async w=>{t(w);let h=!1,g=null;if(w){const{assignedAnswers:s}=w;if(s&&s.length>0){const c=s[0];g=new X(c).chatBotAnswer,h=s.length>1,o(0)}}return{firstChatBotAnswer:g,hasMoreAnswers:h}},m=n.useCallback(async()=>a,[a]),x=n.useCallback(async()=>{const{assignedAnswers:w}=a,h=w.length,g=r+1;return r+1<h?(o(g),{nextChatBotAnswer:new X(w[g]).chatBotAnswer,hasMoreAnswers:g+1<h}):{nextChatBotAnswer:null,hasMoreAnswers:!1}},[a,r]);return[i,m,x]},He="rgba(255, 192, 203, 0.6)",Le="rgb(224, 207, 252)",qe=n.forwardRef(({allCategoryRows:a},t)=>{const[r,o]=n.useState([]);function i({children:s,eventKey:c,hasSubCategories:y,callback:C}){const{activeEventKey:l}=n.useContext(be),S=Se(String(c??""),()=>C&&C(c)),B=l===c;return e.jsx("button",{type:"button",className:`accordion-button${y?"":" hide-icon"}`,style:{backgroundColor:B?He:Le},onClick:S,children:s})}const m=({row:s})=>e.jsxs(D,{children:[e.jsx(D.Header,{children:e.jsx(i,{eventKey:s.id,hasSubCategories:s.hasSubCategories,children:s.link?e.jsx("a",{href:`${s.link}/true`,className:"cat-link",children:s.title}):e.jsx("span",{className:"cat-title",children:s.title})})}),e.jsx(W.Collapse,{eventKey:s.id,children:e.jsx(D.Body,{children:s.hasSubCategories&&e.jsx(x,{rows:s.categoryRows})})})]}),x=({rows:s})=>e.jsx(e.Fragment,{children:s.map(c=>e.jsx(m,{row:c},c.id))}),w=async(s,c)=>{const y=s[0];console.log(a,a.find(C=>y===C.id)),c.preventDefault(),console.log("onSelectCategory",{eventKey:s,e:c})},h=async s=>{const{id:c}=s;return a.forEach(async y=>{y.id!==c&&y.parentId===c&&(await h(y),s.categoryRows.push(y))}),!0},g=()=>{o([]),a.forEach(async s=>{s.categoryRows=[],s.parentId===null&&(await h(s),o(c=>[...c,s]))})};return n.useImperativeHandle(t,()=>({resetNavigator:g}),[]),e.jsx(W,{defaultActiveKey:"MTS",alwaysOpen:!0,onSelect:w,children:e.jsx(x,{rows:r})})}),$e=({show:a,onHide:t})=>{let{tekst:r}=ve();const[o,i]=n.useState(r),[m,x,w]=Me(),[h,g]=n.useState(null),[s,c]=n.useState(1),[y,C]=n.useState(!1),[l,S]=n.useState(null),[B,R]=n.useState(!1),{loadAllCategoryRowsGlobal:H,getQuestion:le,addHistory:L,addHistoryFilter:de,searchQuestions:ce}=ke(),{authUser:T,isDarkMode:ue,allCategoryRowsGlobalLoaded:q,allCategoryRowsGlobal:F}=Be(),[me]=n.useState(!0),[K,O]=n.useState(!0),[$,xe]=n.useState([]),G=n.useRef(null),[he,v]=n.useState([]);let U;(d=>{d[d.AUTO_SUGGEST=0]="AUTO_SUGGEST",d[d.QUESTION=1]="QUESTION",d[d.ANSWER=2]="ANSWER"})(U||(U={})),n.useEffect(()=>{(async()=>q?xe(Array.from(F.values())):await H())()},[q,H]);const fe=async()=>{const d=performance.now();await G?.current?.resetNavigator();const u=performance.now()-d;console.log(`Execution time: ${u} milliseconds`)},we=n.useRef(null),ge=async(d,f)=>{const u=await x();if(u){console.log({questionCurr:u});const A={questionKey:new E(u).questionKey,filter:f,created:{time:new Date,nickName:T.nickName}};await de(A)}if(l){const A={type:2,isDisabled:!0,txt:l.answerTitle,link:l.answerLink};v(I=>[...I,A])}const b=await le(d),{question:p}=b;if(!p)return;p.numOfRelatedFilters>0&&i(p.relatedFilters[0].filter);const je=await m(p);let{firstChatBotAnswer:Ce,hasMoreAnswers:Ae}=je;if(p){const A={type:1,isDisabled:!0,txt:p.title,link:null};v(I=>[...I,A])}c(A=>A+1),O(!1),g(p),C(!0),R(Ae),S(Ce)},pe=async()=>{const d={type:2,isDisabled:!0,txt:l?l.answerTitle:"no answer title",link:l?l.answerLink:"no answer link",hasMoreAnswers:!0};v(u=>[...u,d]);const f={questionKey:new E(h).questionKey,assignedAnswerKey:{topId:l.topId,id:l.id},userAction:"Fixed",created:{nickName:T.nickName,time:new Date}};L(f),R(!1),S(l),C(!1)},ye=async()=>{const d={type:2,isDisabled:!0,txt:l?l.answerTitle:"no answer",link:l?l.answerLink:"no link",hasMoreAnswers:!0};v(p=>[...p,d]);const f=await w(),{nextChatBotAnswer:u,hasMoreAnswers:b}=f;if(l){const p={questionKey:new E(h).questionKey,assignedAnswerKey:{topId:l.topId,id:l.id},userAction:u?"NotFixed":"NotClicked",created:{nickName:T.nickName,time:new Date}};L(p)}R(b),console.log("----->>>>",{nextChatBotAnswer:u}),S(u)},Ne=d=>{const{txt:f}=d;return e.jsx("div",{id:s.toString(),className:"d-flex flex-row mx-0 justify-content-start align-items-center",children:e.jsxs("div",{className:"d-flex flex-row mx-0 justify-content-start align-items-center",children:[e.jsx("img",{width:"22",height:"18",src:Ie,alt:"Question",className:"ms-1"}),e.jsx("div",{className:"p-1 bg-warning text-light flex-wrap text-wrap border rounded-1",children:f})]})})},z=d=>{console.log("--------------------------------------AnswerComponent",d);const{isDisabled:f,txt:u,link:b}=d;return e.jsx("div",{id:l?.id,className:`${ue?"dark":"light"} mt-1 mx-1 border border-0 rounded-1`,children:e.jsxs("div",{className:"d-flex flex-row mx-0 justify-content-start align-items-center",children:[e.jsxs("div",{className:"d-flex flex-row mx-0 justify-content-start align-items-center",children:[e.jsx("img",{width:"22",height:"18",src:Te,alt:"Answer",className:"ms-1"}),b?e.jsx("div",{className:"p-1 bg-info text-light flex-wrap text-wrap border rounded-1 ",children:e.jsx("a",{href:b,rel:"noopener noreferrer",target:"_blank",className:"text-light text-decoration-underline",children:u})}):e.jsx("div",{className:"p-1 bg-info text-light flex-wrap text-wrap border rounded-1",children:u})]}),!f&&l&&e.jsxs("div",{children:[e.jsx(Q,{size:"sm",type:"button",onClick:pe,disabled:!l,className:"align-middle ms-1 px-1  py-0",variant:"success",children:"Fixed"}),e.jsx(Q,{size:"sm",type:"button",onClick:ye,disabled:!l,className:"align-middle ms-1 border border-1 rounded-1 px-1 py-0",variant:"danger",children:"Not fixed"})]})]})})},V=d=>{const{isDisabled:f,txt:u}=d;return e.jsxs("div",{className:"dark",children:[e.jsx("label",{className:"text-warning",children:"Please enter the Question"}),e.jsx("div",{className:"text-start",children:e.jsxs("div",{className:"questions",children:[f&&e.jsx("div",{children:u}),!f&&e.jsx(Qe,{tekst:u,onSelectQuestion:ge,allCategoryRows:F,searchQuestions:ce})]})})]})};return console.log("=====================>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> rendering ChatBotDlg"),$.length===0?e.jsx("div",{children:"Loading ..."}):e.jsxs("div",{className:"pe-6 overflow-auto chat-bot-dlg",children:[e.jsx("style",{children:`
                .card-header {
                    padding: 0.0rem 0.03rem;
                    font-size: 0.8rem;
                }
                // .card-header button  {
                //     border: 0.3px solid silver;
                //     border-radius: 3px;
                //     text-align: left;
                // }

                .card-body {
                    padding: 0.0rem 0.5rem;
                    font-size: 0.6rem;
                }

                .accordion-body {
                    padding: 0.3rem 0.3rem;
                    font-size: 0.6rem;
                }

                .accordion-button  {
                    padding: 0 0.2rem !important;
                    border: 0; //px solid inset;
                    //border-radius: 3px;
                    //text-align: left;
                    font-size: 1rem;
                }
                    
                ul {
                    list-style-type: none;
                }

                .cat-link {
                    // text-decoration:  none;
                    color: inherit;
                }

                .cat-title {
                    // text-decoration:  none;
                    color: inherit;
                }

                .accordion-button.hide-icon::after {
                    display: none;
                }
            }

            `}),e.jsxs(k,{show:a,onHide:t,placement:"end",scroll:!0,backdrop:!0,onEntering:fe,children:[" ",e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{className:"fs-6",children:"I am your Buddy"})}),e.jsx(k.Body,{className:"p-0 border border-1 rounded-3",children:e.jsxs(Re,{id:"container",fluid:!0,className:"text-primary",children:[" ",e.jsx(_,{className:"m-0",children:e.jsx(J,{children:e.jsx(qe,{allCategoryRows:$,ref:G})})}),e.jsx(_,{className:"m-0",children:e.jsxs(J,{className:"border border-0 border-primary mx-1 text-white p-0",children:[e.jsx("div",{className:"history",children:he.map(d=>{switch(d.type){case 0:return e.jsx(V,{...d});case 1:return e.jsx(Ne,{...d});case 2:return e.jsx(z,{...d});default:return e.jsx("div",{children:"unknown"})}})},"history"),y&&e.jsx("div",{children:e.jsx(z,{type:2,isDisabled:!1,txt:l?l.answerTitle:"no answers",hasMoreAnswers:B,link:l?l.answerLink:""})},"answer"),me&&!K&&e.jsx(Q,{variant:"secondary",size:"sm",type:"button",onClick:()=>{c(s+1),O(!0)},className:"m-1 border border-1 rounded-1 py-0",children:"New Question"},"newQuestion"),K&&e.jsx("div",{className:"pb-35 questions",children:e.jsx(V,{type:0,isDisabled:!1,txt:o,link:null})}),e.jsx("div",{ref:we,children:"dno dna"})]})})]})})]})]})};export{$e as default};
//# sourceMappingURL=ChatBotDlg-DclnxoKz.js.map
